# HTTP/2

### ストリームの多重化
HTTP1.1 では、リクエストとレスポンスの組を一つずつしか送信できなかった。（Head Of Line Bloacking）
また、リクエスト/レスポンスの実行順序が保証されている必要があったため、〜。

そのため、HTTP1.1では「リクエストできる数を増やす」「リクエスト数を減らす」工夫が行われた。
- CSSスプライト
- 画像のインライン化
- WEBフォントの利用
- ドメインシャーディング

（いずれも、HTTP2からは意識しなくて良くなる）

HTTP2からは、リクエスト/レスポンスを制限なく並行に処理できるようになった。これは、HTTP2が一つのTCPコネクションの中に、ストリームという単位でメッセージをやりとりできるようになったためである。

HTTP1.1でもKeep-Aliveという、TCPコネクションを使い回す仕組みが存在したが、これにはHOLの問題があったため、完全な意味で並列なリクエストは実現できなかった。

### 双方向通信
サーバープッシュもできるようになった。
（TODO: サーバープッシュのメリットを具体的に調べる）

### ストリームの優先度付け
リソースの取得は、HTMLの上から読み込んだ順番に行われていた。
HTTP2では、「PRIORITYフレーム」が導入され、クライアントから優先度をサーバ側に通知できるようになった。
PRIORITYフレームはあくまでサーバーへの提案であって、その優先度の通りに配信されるといったものではない。

### ヘッダ圧縮
HTTP1.1ではできなかったヘッダ部分の圧縮が可能となった。  
GZIPで実施していたが、脆弱性が発覚したため、HPACKといった圧縮方式が採用された。

## HTTP2の恩恵を受けられないケース
- HTTPS化できない
- 並列リクエストの恩恵が受けられない（初期描画に必要なリソース量が少ない、ドメインシャーディングなどですでに最適化されている）
- パケットロスが多い

## 参考
https://blog.redbox.ne.jp/http2-cdn.html
