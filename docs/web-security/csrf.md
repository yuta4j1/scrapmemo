# CSRF（Cross Site Request Forgery）

https://qiita.com/netebakari/items/41baa7e1d0b8d89f9d12

- CSRFとは、悪意のある攻撃者が用意したWebサイトをユーザーが踏んでしまうことによって、Webサーバーへ間接的に攻撃されてしまう脆弱性
- つまり、クライアント -> サーバーへの悪意のあるリクエスト
- CORSで不正なサイトからのログインを防いでいたとしても、**レスポンスが返らないだけでPOSTリクエスト後の処理が通ってしまう**
    - 例えばレスポンスでエラーになったとしても、不正なデータの登録は成功してしまう
    - （TODO: ここはCORSの仕様を把握しておきたい）
- **プリフライトリクエスト**というものがある
    - 事前リクエストを本リクエストの前に送信し、CORS違反なら本リクエストを送信しない
    - プリフライトリクエストは、「**シンプルなクロスオリジンリクエスト**」には走らない
    - シンプル -> GET, HEAD, POST のいずれか
    - シンプルでない -> DELETE, ```X-API-KEY```ヘッダを持つリクエスト
- つまり、重要なPOSTリクエストの前にはプリフライトリクエストを飛ばすことでCSRFを防ぐ
    - ```X-CSRFToken``` のようなヘッダをつけてリクエストを飛ばす